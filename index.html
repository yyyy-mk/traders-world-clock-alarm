<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>â° ì„¸ê³„ì‹œê°„ ì•ŒëŒ & íƒ€ì´ë¨¸ (for ë¬´ê²½) </title>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3.4.4/build/global/luxon.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .current-time {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
            color: white;
            font-size: 1.1em;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-button {
            flex: 1;
            padding: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .tab-button:hover {
            background: rgba(255,255,255,0.3);
        }

        .tab-button.active {
            background: white;
            color: #667eea;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .time-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .time-input input {
            width: 80px;
            text-align: center;
        }

        .preview {
            color: #667eea;
            font-weight: bold;
            margin-top: 5px;
        }

        .days-selector {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .day-checkbox {
            display: none;
        }

        .day-label {
            padding: 10px 20px;
            background: #f0f0f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }

        .day-checkbox:checked + .day-label {
            background: #667eea;
            color: white;
        }

        .quick-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 0.9em;
        }

        .btn-danger {
            background: #ff6b6b;
            color: white;
        }

        .btn-danger:hover {
            background: #ee5a52;
        }

        .preset-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .alarm-list,
        .timer-list {
            margin-top: 20px;
        }

        .alarm-item,
        .timer-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .alarm-item:hover,
        .timer-item:hover {
            background: #e9ecef;
            transform: translateX(5px);
        }

        .alarm-info {
            flex: 1;
        }

        .alarm-name {
            font-weight: bold;
            font-size: 1.1em;
            color: #333;
            margin-bottom: 5px;
        }

        .alarm-details {
            color: #666;
            font-size: 0.9em;
        }

        .sound-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .sound-selector select {
            flex: 1;
        }

        .timer-controls {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .notification-permission {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .notification-permission button {
            margin-top: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .preset-grid {
                grid-template-columns: 1fr;
            }

            .timer-controls {
                grid-template-columns: repeat(3, 1fr);
            }

            .time-input {
                flex-direction: column;
            }

            .time-input input {
                width: 100%;
            }
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .countdown {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â° ì„¸ê³„ì‹œê°„ ì•ŒëŒ & íƒ€ì´ë¨¸</h1>
            <p>ì¸ë¨¸íƒ€ì„ ìë™ ì ìš© | ë¸Œë¼ìš°ì € ê¸°ë°˜</p>
        </div>

        <div class="current-time" id="currentTime">
            ğŸ‡°ğŸ‡· í•œêµ­: -- | ğŸ‡ºğŸ‡¸ ë‰´ìš•: --
        </div>

        <div id="notificationPermission" class="notification-permission" style="display: none;">
            âš ï¸ ì•ŒëŒê³¼ íƒ€ì´ë¨¸ ì•Œë¦¼ì„ ë°›ìœ¼ë ¤ë©´ ë¸Œë¼ìš°ì € ì•Œë¦¼ ê¶Œí•œì´ í•„ìš”í•©ë‹ˆë‹¤.
            <br>
            <button class="btn btn-primary" onclick="requestNotificationPermission()">ì•Œë¦¼ ê¶Œí•œ í—ˆìš©</button>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('alarms')">â° ì„¸ê³„ì‹œê°„ ì•ŒëŒ</button>
            <button class="tab-button" onclick="switchTab('timers')">â±ï¸ íƒ€ì´ë¨¸</button>
        </div>

        <!-- ì•ŒëŒ íƒ­ -->
        <div id="alarms-tab" class="tab-content active">
            <div class="card">
                <h2>ğŸ“ ìƒˆ ì•ŒëŒ ì¶”ê°€</h2>
                
                <div class="form-group">
                    <label>íƒ€ì„ì¡´</label>
                    <select id="alarmTimezone" onchange="updateKoreaPreview()">
                        <option value="America/New_York">US/Eastern (ë‰´ìš•) - ë¯¸ì¥</option>
                        <option value="America/Chicago">US/Central (ì‹œì¹´ê³ ) - CME</option>
                        <option value="America/Los_Angeles">US/Pacific (LA)</option>
                        <option value="Europe/London">Europe/London (ëŸ°ë˜)</option>
                        <option value="Europe/Paris">Europe/Paris (í”„ë‘í¬í‘¸ë¥´íŠ¸)</option>
                        <option value="Asia/Tokyo">Asia/Tokyo (ë„ì¿„)</option>
                        <option value="Asia/Shanghai">Asia/Shanghai (ìƒí•˜ì´)</option>
                        <option value="Asia/Hong_Kong">Asia/Hong_Kong (í™ì½©)</option>
                        <option value="Asia/Seoul">Asia/Seoul (ì„œìš¸)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>ì‹œê°„ (24ì‹œê°„ í˜•ì‹)</label>
                    <div class="time-input">
                        <input type="number" id="alarmHour" min="0" max="23" value="9" onchange="updateKoreaPreview()">
                        <span>ì‹œ</span>
                        <input type="number" id="alarmMinute" min="0" max="59" value="30" onchange="updateKoreaPreview()">
                        <span>ë¶„</span>
                    </div>
                    <div class="preview" id="koreaPreview"></div>
                </div>

                <div class="form-group">
                    <label>ì•ŒëŒ ì´ë¦„</label>
                    <input type="text" id="alarmName" placeholder="ì˜ˆ: ë¯¸ì¥ ê°œì¥" value="ë¯¸ì¥ ê°œì¥">
                </div>

                <div class="form-group">
                    <label>ìš”ì¼ ì„ íƒ</label>
                    <div class="days-selector">
                        <input type="checkbox" id="day0" class="day-checkbox" checked>
                        <label for="day0" class="day-label">ì›”</label>
                        
                        <input type="checkbox" id="day1" class="day-checkbox" checked>
                        <label for="day1" class="day-label">í™”</label>
                        
                        <input type="checkbox" id="day2" class="day-checkbox" checked>
                        <label for="day2" class="day-label">ìˆ˜</label>
                        
                        <input type="checkbox" id="day3" class="day-checkbox" checked>
                        <label for="day3" class="day-label">ëª©</label>
                        
                        <input type="checkbox" id="day4" class="day-checkbox" checked>
                        <label for="day4" class="day-label">ê¸ˆ</label>
                        
                        <input type="checkbox" id="day5" class="day-checkbox">
                        <label for="day5" class="day-label">í† </label>
                        
                        <input type="checkbox" id="day6" class="day-checkbox">
                        <label for="day6" class="day-label">ì¼</label>
                    </div>
                    <div class="quick-buttons">
                        <button class="btn btn-secondary btn-small" onclick="setWeekdays()">í‰ì¼ë§Œ</button>
                        <button class="btn btn-secondary btn-small" onclick="setAllDays()">ë§¤ì¼</button>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="addAlarm()" style="width: 100%; margin-top: 10px;">
                    âœ“ ì•ŒëŒ ì¶”ê°€
                </button>
            </div>

            <div class="card">
                <h2>âš¡ ë¹ ë¥¸ ì„¤ì •</h2>
                <div class="preset-grid">
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('America/New_York', 4, 0, 'ë¯¸ì¥ í”„ë¦¬ë§ˆì¼“')">ë¯¸ì¥ í”„ë¦¬ë§ˆì¼“ (04:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('America/New_York', 9, 30, 'ë¯¸ì¥ ê°œì¥')">ë¯¸ì¥ ê°œì¥ (09:30)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('America/New_York', 16, 0, 'ë¯¸ì¥ ë§ˆê°')">ë¯¸ì¥ ë§ˆê° (16:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Europe/London', 8, 0, 'ëŸ°ë˜ ê°œì¥')">ëŸ°ë˜ ê°œì¥ (08:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 9, 30, 'í™ì½© ì˜¤ì „ì¥')">í™ì½© ì˜¤ì „ì¥ (09:30)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 12, 0, 'í™ì½© ì ì‹¬ì‹œê°„')">í™ì½© ì ì‹¬ì‹œê°„ (12:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 13, 0, 'í™ì½© ì˜¤í›„ì¥')">í™ì½© ì˜¤í›„ì¥ (13:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 16, 0, 'í™ì½© ì •ê·œì¥ ë§ˆê°')">í™ì½© ì •ê·œì¥ ë§ˆê° (16:00)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 17, 15, 'í™ì½© ì•¼ê°„ì„ ë¬¼')">í™ì½© ì•¼ê°„ì„ ë¬¼ (17:15)</button>
                    <button class="btn btn-secondary btn-small" onclick="addPresetAlarm('Asia/Hong_Kong', 1, 0, 'í™ì½© ì•¼ê°„ ë§ˆê°')">í™ì½© ì•¼ê°„ ë§ˆê° (01:00)</button>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“‹ ë“±ë¡ëœ ì•ŒëŒ</h2>
                <div id="alarmList" class="alarm-list">
                    <div class="empty-state">ë“±ë¡ëœ ì•ŒëŒì´ ì—†ìŠµë‹ˆë‹¤.</div>
                </div>
                <button class="btn btn-danger btn-small" onclick="clearAllAlarms()" style="margin-top: 10px;">
                    ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ
                </button>
            </div>
        </div>

        <!-- íƒ€ì´ë¨¸ íƒ­ -->
        <div id="timers-tab" class="tab-content">
            <div class="card">
                <h2>â±ï¸ ìƒˆ íƒ€ì´ë¨¸ ì„¤ì •</h2>
                
                <div class="form-group">
                    <label>íƒ€ì´ë¨¸ ì´ë¦„ (ì„ íƒ)</label>
                    <input type="text" id="timerName" placeholder="ì˜ˆ: ì°¨íŠ¸ ì²´í¬">
                </div>

                <div class="form-group">
                    <label>ì‹œê°„ ì„¤ì •</label>
                    <div class="time-input">
                        <input type="number" id="timerHour" min="0" max="23" value="0">
                        <span>ì‹œê°„</span>
                        <input type="number" id="timerMinute" min="0" max="59" value="5">
                        <span>ë¶„</span>
                        <input type="number" id="timerSecond" min="0" max="59" value="0">
                        <span>ì´ˆ</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>ë¹ ë¥¸ ì„¤ì •</label>
                    <div class="timer-controls">
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,1,0)">1ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,3,0)">3ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,5,0)">5ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,10,0)">10ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,15,0)">15ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,30,0)">30ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(0,45,0)">45ë¶„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(1,0,0)">1ì‹œê°„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(2,0,0)">2ì‹œê°„</button>
                        <button class="btn btn-secondary btn-small" onclick="setTimer(4,0,0)">4ì‹œê°„</button>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startTimer()" style="width: 100%; margin-top: 10px;">
                    â–¶ íƒ€ì´ë¨¸ ì‹œì‘
                </button>
            </div>

            <div class="card">
                <h2>ğŸƒ ì‹¤í–‰ ì¤‘ì¸ íƒ€ì´ë¨¸</h2>
                <div id="timerList" class="timer-list">
                    <div class="empty-state">ì‹¤í–‰ ì¤‘ì¸ íƒ€ì´ë¨¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>
                </div>
                <button class="btn btn-danger btn-small" onclick="stopAllTimers()" style="margin-top: 10px;">
                    â¹ï¸ ì „ì²´ ì •ì§€
                </button>
            </div>
        </div>
    </div>

    <script>
        const { DateTime } = luxon;
        
        // ë°ì´í„°
        let alarms = [];
        let timers = [];
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í‚¤
        const ALARMS_KEY = 'world_time_alarms';
        
        // ì´ˆê¸°í™”
        function init() {
            loadAlarms();
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            setInterval(checkAlarms, 1000);
            setInterval(updateTimers, 500);
            updateKoreaPreview();
            checkNotificationPermission();
        }
        
        // ì•Œë¦¼ ê¶Œí•œ ì²´í¬
        function checkNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                document.getElementById('notificationPermission').style.display = 'block';
            }
        }
        
        // ì•Œë¦¼ ê¶Œí•œ ìš”ì²­
        function requestNotificationPermission() {
            Notification.requestPermission().then(permission => {
                if (permission === 'granted') {
                    document.getElementById('notificationPermission').style.display = 'none';
                    alert('ì•Œë¦¼ ê¶Œí•œì´ í—ˆìš©ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
                }
            });
        }
        
        // íƒ­ ì „í™˜
        function switchTab(tab) {
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab + '-tab').classList.add('active');
        }
        
        // í˜„ì¬ ì‹œê°„ ì—…ë°ì´íŠ¸
        function updateCurrentTime() {
            const korea = DateTime.now().setZone('Asia/Seoul');
            const newYork = DateTime.now().setZone('America/New_York');
            
            document.getElementById('currentTime').textContent = 
                `ğŸ‡°ğŸ‡· í•œêµ­: ${korea.toFormat('yyyy-MM-dd HH:mm:ss')} | ğŸ‡ºğŸ‡¸ ë‰´ìš•: ${newYork.toFormat('yyyy-MM-dd HH:mm:ss')}`;
        }
        
        // í•œêµ­ì‹œê°„ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        function updateKoreaPreview() {
            const timezone = document.getElementById('alarmTimezone').value;
            const hour = parseInt(document.getElementById('alarmHour').value) || 0;
            const minute = parseInt(document.getElementById('alarmMinute').value) || 0;
            
            try {
                const dt = DateTime.now().setZone(timezone).set({ hour, minute });
                const koreaTime = dt.setZone('Asia/Seoul');
                
                document.getElementById('koreaPreview').textContent = 
                    `â†’ í•œêµ­ì‹œê°„: ${koreaTime.toFormat('HH:mm')}`;
            } catch (e) {
                document.getElementById('koreaPreview').textContent = '';
            }
        }
        
        // ìš”ì¼ ì„¤ì •
        function setWeekdays() {
            for (let i = 0; i < 7; i++) {
                document.getElementById('day' + i).checked = i < 5;
            }
        }
        
        function setAllDays() {
            for (let i = 0; i < 7; i++) {
                document.getElementById('day' + i).checked = true;
            }
        }
        
        // ì•ŒëŒ ì¶”ê°€
        function addAlarm() {
            const timezone = document.getElementById('alarmTimezone').value;
            const hour = parseInt(document.getElementById('alarmHour').value);
            const minute = parseInt(document.getElementById('alarmMinute').value);
            const name = document.getElementById('alarmName').value.trim();
            
            if (!name) {
                alert('ì•ŒëŒ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }
            
            const days = [];
            for (let i = 0; i < 7; i++) {
                if (document.getElementById('day' + i).checked) {
                    days.push(i);
                }
            }
            
            if (days.length === 0) {
                alert('ìµœì†Œ í•˜ë‚˜ì˜ ìš”ì¼ì„ ì„ íƒí•˜ì„¸ìš”.');
                return;
            }
            
            const alarm = {
                id: Date.now(),
                timezone,
                hour,
                minute,
                name,
                days,
                enabled: true
            };
            
            alarms.push(alarm);
            saveAlarms();
            updateAlarmList();
            alert(`ì•ŒëŒì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤: ${name}`);
        }
        
        // í”„ë¦¬ì…‹ ì•ŒëŒ ì¶”ê°€
        function addPresetAlarm(timezone, hour, minute, name) {
            const alarm = {
                id: Date.now(),
                timezone,
                hour,
                minute,
                name,
                days: [0, 1, 2, 3, 4], // í‰ì¼
                enabled: true
            };
            
            alarms.push(alarm);
            saveAlarms();
            updateAlarmList();
            alert(`"${name}" ì•ŒëŒì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }
        
        // ì•ŒëŒ ì‚­ì œ
        function deleteAlarm(id) {
            if (confirm('ì´ ì•ŒëŒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                alarms = alarms.filter(a => a.id !== id);
                saveAlarms();
                updateAlarmList();
            }
        }
        
        // ì „ì²´ ì•ŒëŒ ì‚­ì œ
        function clearAllAlarms() {
            if (alarms.length === 0) {
                alert('ì‚­ì œí•  ì•ŒëŒì´ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm('ëª¨ë“  ì•ŒëŒì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                alarms = [];
                saveAlarms();
                updateAlarmList();
            }
        }
        
        // ì•ŒëŒ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateAlarmList() {
            const listEl = document.getElementById('alarmList');
            
            if (alarms.length === 0) {
                listEl.innerHTML = '<div class="empty-state">ë“±ë¡ëœ ì•ŒëŒì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            listEl.innerHTML = alarms.map(alarm => {
                const dt = DateTime.now().setZone(alarm.timezone).set({ 
                    hour: alarm.hour, 
                    minute: alarm.minute 
                });
                const koreaTime = dt.setZone('Asia/Seoul');
                const daysStr = formatDays(alarm.days);
                
                return `
                    <div class="alarm-item">
                        <div class="alarm-info">
                            <div class="alarm-name">${alarm.name}</div>
                            <div class="alarm-details">
                                ${alarm.timezone} ${String(alarm.hour).padStart(2, '0')}:${String(alarm.minute).padStart(2, '0')} 
                                â†’ í•œêµ­ ${koreaTime.toFormat('HH:mm')} | ${daysStr}
                            </div>
                        </div>
                        <button class="btn btn-danger btn-small" onclick="deleteAlarm(${alarm.id})">
                            ğŸ—‘ï¸ ì‚­ì œ
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        // ìš”ì¼ í¬ë§·íŒ…
        function formatDays(days) {
            const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
            if (days.length === 7) return 'ë§¤ì¼';
            if (days.length === 5 && days.every(d => d < 5)) return 'í‰ì¼';
            if (days.length === 2 && days.includes(5) && days.includes(6)) return 'ì£¼ë§';
            return days.map(d => dayNames[d]).join(', ');
        }
        
        // ì•ŒëŒ ì²´í¬
        function checkAlarms() {
            const now = DateTime.now().setZone('Asia/Seoul');
            const currentDay = (now.weekday % 7); // luxonì˜ weekdayëŠ” 1(ì›”)~7(ì¼)
            const currentMinute = now.toFormat('HH:mm');
            
            alarms.forEach(alarm => {
                if (!alarm.enabled || !alarm.days.includes(currentDay)) return;
                
                const dt = DateTime.now().setZone(alarm.timezone).set({
                    hour: alarm.hour,
                    minute: alarm.minute
                });
                const alarmTimeKR = dt.setZone('Asia/Seoul');
                const alarmMinute = alarmTimeKR.toFormat('HH:mm');
                
                if (currentMinute === alarmMinute) {
                    if (!alarm.lastTriggered || now.diff(alarm.lastTriggered, 'minutes').minutes >= 1) {
                        triggerAlarm(alarm);
                        alarm.lastTriggered = now;
                    }
                }
            });
        }
        
        // ì•ŒëŒ íŠ¸ë¦¬ê±°
        function triggerAlarm(alarm) {
            console.log('â° ì•ŒëŒ:', alarm.name);
            
            // ë¸Œë¼ìš°ì € ì•Œë¦¼
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('â° ì•ŒëŒ', {
                    body: `${alarm.name}\n${alarm.timezone} ${String(alarm.hour).padStart(2, '0')}:${String(alarm.minute).padStart(2, '0')}`,
                    icon: 'â°',
                    tag: 'alarm-' + alarm.id
                });
            }
            
            // ì†Œë¦¬
            playBeep();
            
            // ì•Œë¦¼ì°½
            alert(`â° ì•ŒëŒ\n\n${alarm.name}\n\nì„¤ì •ì‹œê°„: ${alarm.timezone} ${String(alarm.hour).padStart(2, '0')}:${String(alarm.minute).padStart(2, '0')}\ní˜„ì¬ì‹œê°„: ${DateTime.now().toFormat('yyyy-MM-dd HH:mm:ss')}`);
        }
        
        // íƒ€ì´ë¨¸ ì„¤ì •
        function setTimer(h, m, s) {
            document.getElementById('timerHour').value = h;
            document.getElementById('timerMinute').value = m;
            document.getElementById('timerSecond').value = s;
        }
        
        // íƒ€ì´ë¨¸ ì‹œì‘
        function startTimer() {
            const hours = parseInt(document.getElementById('timerHour').value) || 0;
            const minutes = parseInt(document.getElementById('timerMinute').value) || 0;
            const seconds = parseInt(document.getElementById('timerSecond').value) || 0;
            
            const totalSeconds = hours * 3600 + minutes * 60 + seconds;
            
            if (totalSeconds <= 0) {
                alert('íƒ€ì´ë¨¸ ì‹œê°„ì„ 0ë³´ë‹¤ í¬ê²Œ ì„¤ì •í•˜ì„¸ìš”.');
                return;
            }
            
            let name = document.getElementById('timerName').value.trim();
            if (!name) {
                name = `${hours}ì‹œê°„ ${minutes}ë¶„ ${seconds}ì´ˆ`;
            }
            
            const timer = {
                id: Date.now(),
                name,
                endTime: Date.now() + (totalSeconds * 1000),
                totalSeconds,
                active: true
            };
            
            timers.push(timer);
            updateTimerList();
            
            // ì…ë ¥ ì´ˆê¸°í™”
            document.getElementById('timerName').value = '';
        }
        
        // íƒ€ì´ë¨¸ ì •ì§€
        function stopTimer(id) {
            const timer = timers.find(t => t.id === id);
            if (timer) {
                timer.active = false;
                updateTimerList();
            }
        }
        
        // ì „ì²´ íƒ€ì´ë¨¸ ì •ì§€
        function stopAllTimers() {
            if (timers.filter(t => t.active).length === 0) {
                alert('ì‹¤í–‰ ì¤‘ì¸ íƒ€ì´ë¨¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            if (confirm('ëª¨ë“  íƒ€ì´ë¨¸ë¥¼ ì •ì§€í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                timers.forEach(t => t.active = false);
                updateTimerList();
            }
        }
        
        // íƒ€ì´ë¨¸ ë¦¬ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
        function updateTimers() {
            const now = Date.now();
            
            timers.forEach(timer => {
                if (!timer.active) return;
                
                const remaining = timer.endTime - now;
                
                if (remaining <= 0) {
                    timer.active = false;
                    triggerTimer(timer);
                }
            });
            
            // ë¹„í™œì„± íƒ€ì´ë¨¸ ì œê±°
            timers = timers.filter(t => t.active);
            
            updateTimerList();
        }
        
        // íƒ€ì´ë¨¸ ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
        function updateTimerList() {
            const listEl = document.getElementById('timerList');
            const activeTimers = timers.filter(t => t.active);
            
            if (activeTimers.length === 0) {
                listEl.innerHTML = '<div class="empty-state">ì‹¤í–‰ ì¤‘ì¸ íƒ€ì´ë¨¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            listEl.innerHTML = activeTimers.map(timer => {
                const now = Date.now();
                const remaining = Math.max(0, timer.endTime - now);
                const hours = Math.floor(remaining / 3600000);
                const minutes = Math.floor((remaining % 3600000) / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                
                return `
                    <div class="timer-item">
                        <div class="alarm-info">
                            <div class="alarm-name">${timer.name}</div>
                            <div class="countdown">
                                ë‚¨ì€ì‹œê°„: ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}
                            </div>
                        </div>
                        <button class="btn btn-danger btn-small" onclick="stopTimer(${timer.id})">
                            â¹ï¸ ì •ì§€
                        </button>
                    </div>
                `;
            }).join('');
        }
        
        // íƒ€ì´ë¨¸ íŠ¸ë¦¬ê±°
        function triggerTimer(timer) {
            console.log('â±ï¸ íƒ€ì´ë¨¸ ì™„ë£Œ:', timer.name);
            
            // ë¸Œë¼ìš°ì € ì•Œë¦¼
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('â±ï¸ íƒ€ì´ë¨¸ ì™„ë£Œ', {
                    body: `${timer.name}\níƒ€ì´ë¨¸ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`,
                    icon: 'â±ï¸',
                    tag: 'timer-' + timer.id
                });
            }
            
            // ì†Œë¦¬
            playBeep();
            
            // ì•Œë¦¼ì°½
            alert(`â±ï¸ íƒ€ì´ë¨¸ ì™„ë£Œ\n\n${timer.name}\n\níƒ€ì´ë¨¸ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!`);
        }
        
        // ë¹„í”„ìŒ ì¬ìƒ
        function playBeep() {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.5);
        }
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì €ì¥
        function saveAlarms() {
            localStorage.setItem(ALARMS_KEY, JSON.stringify(alarms));
        }
        
        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ë¡œë“œ
        function loadAlarms() {
            const saved = localStorage.getItem(ALARMS_KEY);
            if (saved) {
                try {
                    alarms = JSON.parse(saved);
                    updateAlarmList();
                } catch (e) {
                    console.error('ì•ŒëŒ ë¡œë“œ ì‹¤íŒ¨:', e);
                }
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.addEventListener('load', init);
    </script>
</body>
</html>
